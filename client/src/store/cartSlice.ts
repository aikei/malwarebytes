import { createSlice } from '@reduxjs/toolkit'
import axios from 'axios';

const initialState: {
  items: any[]
} = {
  items: [],
}

const cartSlice = createSlice({
  name: 'cart',
  initialState,
  reducers: {
    updateCart(state, action) {
      state.items = action.payload;
    },
    addToCart(state, action) {
      state.items.push(action.payload.item.id);
      axios.post('/devices/updateCart', {
        cart: state.items,
        id: action.payload.id,
      });
    },
    removeFromCart(state, action) {
      const i = state.items.findIndex((v) => v === action.payload.item.id);
      if (i !== -1) {
        state.items.splice(i, 1);
      }
      axios.post('/devices/updateCart', {
        cart: state.items,
        id: action.payload.id,
      });
    }
  }
});

export type CartStateType = typeof initialState;

export const { updateCart, addToCart, removeFromCart } = cartSlice.actions;

export default cartSlice.reducer;