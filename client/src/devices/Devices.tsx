import React, {FC} from 'react'
import { useSelector, useDispatch } from 'react-redux'
import { openModal } from '../store/modalSlice'
import { fetchDevices } from '../store/devicesSlice'
import { State } from '../store/store'

const Devices: FC = () => {

  const dispatch = useDispatch();
  const devices = useSelector<State, {type:string,name:string,index:number}[]>((state) => state.devices.devices)
  const quantities = useSelector<State, {[key: string]: number}>((state) => state.devices.quantities)

  React.useEffect(() => {
    dispatch(fetchDevices())
  }, [])

  return (<div>
    <table className='table'>
      <thead>
        <tr>
          <th scope='col'>#</th>
          <th scope='col'>Device</th>
          <th scope='col'>Quantity</th>
        </tr>
      </thead>
      <tbody>
        {devices && devices.map((device: any, index: number) => {
          return (<tr key={'device-' + index}>
            <th>{device.index}</th>
            <td>
              <div style={{cursor: 'pointer', color: 'blue', textDecoration: 'underline' }} onClick={() => dispatch(openModal(device))}>
                {device.name}
              </div>
            </td>
            <td>
              <input readOnly type="number" value={quantities[device.id]} />
            </td>
          </tr>)
        })}
      </tbody>
    </table>
  </div>)
}

export default Devices;
